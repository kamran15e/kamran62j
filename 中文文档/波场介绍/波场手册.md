# TRON

## 核心架构

![](https://raw.githubusercontent.com/ybhgenius/Documentation/master/images/Architecture.png)

TRON采用了三层体系架构，分别为存储层，核心层和应用层。

+ 存储层 

    TRON的技术团队为TRON设计了独特的分布式存储协议，包括区块存储和状态存储。  
    在存储层的设计中，TRON引入了图数据库的思想，来更便捷的满足现实世界多样性数据存储的需求。

+ 核心层

    TRON包含智能合约，账户管理，共识等模块。TRON将会实现基于堆栈式的虚拟机，并且采用优化过的指令集。  
    为了让开发者更好的开发DApp，TRON采用Java语言作为合约语言，后续会加入更多的高级语言支持。  
    另外为了满足TRON独特的需求，TRON的共识机制在DPOS基础上做了一定的创新。

+ 应用层
    
    开发者可以使用接口来方便的实现丰富的DApp和个性化钱包。
    波场的协议完全使用google protobuf来定义，天然的支持多语言扩展。

## 共识机制

+ 基于DPOS改良过的共识机制

    POW共识机制一直存在浪费资源、效率低下、TPS不高的问题。这些都与TRON的价值观、定位不吻合。基于我们的设计理念，为了真正实现能用于日常场景的区块链平台，我们选择了POS机制作为TRON的共识机制的基调。TRON的共识机制从DPOS出发。在调查了现有领域的优秀改进想法后，我们对DPOS机制作出改进，以达到我们的需求，从而确定了TRON的共识。

+ 共识机制基本原则
   
    + 用户会根据自己手里的具有可投票权的币持有量做出带有权重的投票，根据投票结果，按照一定的规则选择出当前的区块生成节点。参照的规则会尽可能的保证区块的生成速度与打包节点数量之间的平衡性。
    + 同时，落选的打包节点、投票给中选者的用户、投票给落选者的用户均可能获得一定量的补偿，以激励他们持续参与之后的竞选流程。
    + 中选节点会按照一定的分配规则依次进行区块的打包并获得最大份额的奖励。
    + 中选节点中的多数会根据投票结果进行选择，剩下的会按照一定的算法保证在余下的其他节点中，所有节点都有可能被选中。

## 存储结构

+ KhaosDB

    TRON采用的KhaosDB会存储一定时间内所有新产生的分叉链。当发生需要切换主链的情况时，在KhaosDB的支持下，验证节点可以快速切换有效链到新的主链。

+ Level DB

    为了同时满足存取速度和快速开发的需求，TRON会在开发初期采用Level DB。在主网上线后，TRON将会根据实际需求进行数据库的升级，使得TRON具有完全量身定制的数据库。

## 数字资产模块

+ 配置

    数字资产配置。通过该模块，用户可以按照自己的意愿进行自定义的数字资产的定制。
    可定制的参数包括但不限于资产的名称、缩写、LOGO、总的发行量、TRX兑换比例，开始时间、 结束时间、兑换比例衰减系数、是否可增发、增发形式（一定数目或者一定比率）、增发周期、描述等。
    用户也可以选择不进行参数的配置。系统会为用户配置默认的参数。

+ 发布/部署
    
    参数配置完成后（人为或者系统默认），用户即可选择发布资产。
    对配置好的并通过验证的数字资产进行部署的各种操作、功能。
    通过见证节点的验证后，自定义资产就完成了部署。完成部署的资产可以自由的在TRON网络上流通。

+ API
    API接口主要用于支持客户端的开发。开发者可以在API接口的支持下，开发完全由自己设计的资产发布平台。

## 智能合约/虚拟机

TRON包含智能合约模块，用户可以开发自己的智能合约，从而定制化的满足用户需求。  
智能合约会运行在虚拟机上，TRON将会实现自己的虚拟机，开发者们可以实现复杂多样的功能，满足定制化需求 。

## 第三方应用

+ 数字资产部署平台

    TRON会允许第三方开发自己的平台，并接入TRON网络。利用TRON的数字资产模块进行，第三方平台的用户也可以自行定义自己的数字资产。

+ 钱包
    
    可以用于查看TRX及用户持有的其他资产的信息，发起或者接受交易等。

+ 区块链浏览器
    
    查看整个TRON的区块记录，节点名单，节点部署、实时运行情况等。

## 令牌迁移

在TRON网络主网正式部署前，波场基金会会组织由目前的基于以太坊ERC20的令牌向正式的TRON主网代币TRX的迁移，迁移兑换比例为1：1。具体的迁移方式待定，并可能在正式执行前进行细节上的修改。

##社区计划

社区是一个区块链项目的重要组成部分。我们希望能够激励社区成员的热情，使得所有人充分的参与到波场的建设中来。这也是我们从项目伊始就确定下来，从未改变过的想法。  
社区成员有多种途径能够参与到波场项目中来。广大的开发者可以参与到波场核心的代码编写中来，也可以在我们开放API后进行第三方应用的开发。另外我们还会不定期组织一些竞赛活动，向所有的网络用户征稿，包括但不限于LOGO设计、文章、海报、编程竞赛等形式。

+ 提交类型
    
    + feat: 新的功能。
    + fix: 漏洞修复。
    + docs: 文档类修改。
    + perf: 能够提高性能的代码修改。
    + refactor: 重构（既不添加新功能也不修复漏洞的代码改变）。
    + style: 文本格式修改(多余的空白, 格式校对, 标点符号遗漏等)。
    + test: 添加缺失的测试用例、修改现存测试用例。

+ 奖励计划	

我们会对为TRON网络及社区的推进、发展做出贡献的人给与奖励。我们会成立一个委员会对所有的贡献者进行详细的评估，根据评估结果给与对应数量的TRX代币、礼品等多种形式的奖励。
	
## 协议

TRON使用Google protobuf协议，协议内容涉及到账户，区块，传输多个层面。

账户有基本账户、资产发布账户和合约账户三种类型。一个账户包含，账户名称，账户类型，地址，余额，投票，其他资产6种属性。

更进一步的，基本账户可以申请成为验证节点，验证节点具有额外的属性，投票统计数目，公钥，URL，以及历史表现等参数。

一个区块由区块头和多笔交易构成。区块头包含时间戳，交易字典树的根，父哈希，签名等区块基本信息。

交易合约有多种类型，包括账户创建合约、转账合约、资产转账合约、资产投票合约、见证节点投票合约、见证节点创建合约、资产发布合约、部署合约8种类型。

每一个交易还包含多个输入与多个输出，以及其他一些相关属性。

其中交易内的输入，交易本身，区块头均需签名。

传输涉及的协议Inventory主要用于传输中告知接收方传输数据的清单。

详细的协议见附属文件。详细协议随着程序的迭代随时都可能发生变化，请以最新的版本为准。

