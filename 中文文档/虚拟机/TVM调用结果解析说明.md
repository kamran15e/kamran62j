# Tron virtual machine 调用结果说明

# 概述
当调用getTransactionInfoById接口得到contractResult后，需要开发者自行解析结果。

getTransactionById接口用于获取交易上链后的状态。对于智能合约而言，ret字段为此合约是否执行成功的记录，失败结果有多种情况。

此说明用于对getTransactionById的ret字段和getTransactionInfoById的contractResult字段结果的解释和分析。

# getTransactionInfoById结果实例

        txid: 
        33ebb296d6c884127343d6e4fe3ad7a162559b55aa1f24f3a5247e02e1fd234b
        fee: 
        17200
        blockNumber: 
        2758043
        blockTimeStamp: 
        1538201871000
        result: 
        SUCCESS
        resMessage: 
        
        contractResult: 
        0000000000000000000000000000000000000000000000000000000000000009
        contractAddress: 
        TVMCU221WnGfTBcCo7RMQ3X6rf9X1FKTUk
        logList: 
        
        receipt: 
        EnergyUsage: 
        0
        EnergyFee(SUN): 
        17200
        OriginEnergyUsage: 
        0
        EnergyUsageTotal: 
        172
        NetUsage: 
        280
        NetFee: 
        0

txid: 包含调用合约方法信息的交易id

fee:  本次调用的花费，单位sun

blockNumber: 打包交易的区块编号

blockTimeStamp: 打包交易区块的时间戳

result: 交易执行的状态结果

resMessage: 交易失败时返回的信息

contractResult: 合约调用返回的结果

contractAddress: 调用的合约地址

logList: 如果有事件等打出的log信息

receipt: 包含5个字段，见https://github.com/tronprotocol/Documentation/blob/master/中文文档/虚拟机/Energy消耗机制.md

# contractResult详解
contractResult字段显示了合约调用的直接返回结果，由HexString的形式展示。以每64个16进制字符（32bytes）为一个字，根据返回值类型分别显示。

A. 定长变量

实例1. 单返回值 uint:

```
function foo() returns(uint256){...};
contractResult:
000000000000000000000000000000000000000000000000000000000000000b
解析:
返回为uint256类型10进制 11
```


实例2. 多返回值 （bytes8,uint256）:

```
function createTest() public returns(bytes8,uint256){return (11,1);}
  contractResult:000000000000000b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001
解析:
 000000000000000b000000000000000000000000000000000000000000000000  bytes8结果
 0000000000000000000000000000000000000000000000000000000000000001  uint256结果
```



B. 不定长变量

实例3. 多返回值及数组(bytes8,uint256[],string)

        function bar() public returns(bytes8,uint256[],string){
                uint256[] memory a= new uint256[](10);
                a[0]=1;
                string memory s ="tron";
                return (11,a,s);
         }
    
    contractResult:000000000000000b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000474726f6e00000000000000000000000000000000000000000000000000000000
    
    解析:
    000000000000000b000000000000000000000000000000000000000000000000     第一个定长bytes8参数的数值
    0000000000000000000000000000000000000000000000000000000000000060     第二个非定长变量（数组）的指针位置
    00000000000000000000000000000000000000000000000000000000000001c0     第三个非定长变量（string）
    000000000000000000000000000000000000000000000000000000000000000a     第二个变量的长度 （10）
    0000000000000000000000000000000000000000000000000000000000000001     第二个变量的第0位的值 （1）
    0000000000000000000000000000000000000000000000000000000000000000     第二个变量的第1位的值 （0）
    0000000000000000000000000000000000000000000000000000000000000000     第二个变量的第2位的值 （0）
    0000000000000000000000000000000000000000000000000000000000000000     ...
    0000000000000000000000000000000000000000000000000000000000000000     ...
    0000000000000000000000000000000000000000000000000000000000000000     ...
    0000000000000000000000000000000000000000000000000000000000000000     ...
    0000000000000000000000000000000000000000000000000000000000000000     ...
    0000000000000000000000000000000000000000000000000000000000000000     ...
    0000000000000000000000000000000000000000000000000000000000000000     第二个变量的第9位的值 （0）
    0000000000000000000000000000000000000000000000000000000000000004     第三个非定长变量的长度（4）
    74726f6e00000000000000000000000000000000000000000000000000000000     16进制的ascii码，对应"tron"

# getTransactionById结果实例

```shell
gettransactionbyid acf1815ceef75bb1c9ccce5bc8439aee8a34ca7bc2b4649d34ed1f3bc6a7de74

hash:f6134b6dd5d3e7cffc62c52bff9deae19c92973b0a8ae7904d8d4472a87ef0e3
txid:acf1815ceef75bb1c9ccce5bc8439aee8a34ca7bc2b4649d34ed1f3bc6a7de74
raw_data: 
{
ref_block_bytes: 9002
ref_block_hash: ca65eb0f6f0764a7
contract: 
{
contract 0 :::
[
contract_type: TriggerSmartContract
owner_address: TRxSunZ8cjJRZdub5dsDjSgGeCqq5ycAXR
contract_address: TEV3mQuXubrbTzc2MApZvvH6btKJ4eZh41
call_value:0
data:67e0badb
]

}
timestamp: Tue Oct 16 20:13:24 CST 2018
fee_limit: 10000000
}
signature: 
{
signature 0 :5d8d6c366ee9335a211e9a5c3cac6b4ad904d6b9a8aa7f098f7b2165f7df54a74c4c846de709d654a71ef17090e3a1461541f99190ce58e0fb2c6f14ae0a788c00
}
ret: 
{
result: 0 ::: 
[
code ::: SUCESS
]
}

```

hash:交易的HASH值

txid:本交易的交易id

raw_data:交易内容的具体内容

signature:交易签名信息

ret:交易执行基本结果（是否成功及扣费情况）

# ret详解

ret字段记录该交易执行的节本结果信息。

```
code ::: SUCESS
```

code: 交易执行是否成功，除标识成功的SUCESS外还有以下几种表示失败的结果

```
REVERT //合约中执行回退操作
BAD_JUMP_DESTINATION //合约中指令跳转异常
OUT_OF_MEMORY //合约中使用TVM虚拟机的memory超过3M
STACK_TOO_SMALL //合约中指令STACK存储参数异常
STACK_TOO_LARGE //合约中指令STACK存储参数异常
ILLEGAL_OPERATION //合约中执行到非法指令
STACK_OVERFLOW //合约过程中TVM堆栈使用超过1024
OUT_OF_ENERGY //合约执行过程中fee_limit提供的ENERGY不足
OUT_OF_TIME //合约执行时间超过50ms
JVM_STACK_OVER_FLOW //合约过程中发生JVM栈溢出
```



